<?xml version="1.0" ?>
<openerp>
    <data noupdate="1">
        <record id="client_form_kuitansi_id" model="via.form.templates">
            <field name="name">Kwitansi</field>
            <field name="model_id" ref="account_voucher.model_account_voucher"/>
            <field eval="False" name="company_id"/>
            <field name="engine">mako</field>
            <field name="report_output">pdf</field>
            <field name="multi">True</field>
            <field name="webkit_header" ref="via_report_webkit.ir_header_webkit_plain_a5l"/>
            <field name="template">
                <![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!--
################################################################################
Nomor Template  : KUI001
Versi Template  : v1
Revisi Template : 11 Mar 2014
Copyright       : PT. Vikasa Infinity Anugrah (www.infi-nity.com)
Deskripsi:
Template untuk formulir sejenis kuitansi
Log:
19 Mar 2014 [Siti Ida Riyani] - Formalisasi versi pertama.
################################################################################
-->

<!--
################################################################################
I. DEKLARASI VARIABLE - KONFIGURASI
################################################################################
-->
<!-- Import library python yang dibutuhkan di sini -->
<%from math import log10%>
<%from math import fmod%>
<%import re%>

<!-- Konfigurasi Bagian [A]-->
<%wrong_document_state = [] %>                          <!--Dipakai untuk menyimpan daftar dan status dari dokumen-dokumen yang tidak akan dicetak (status invalid)-->
<%total_document = len(objects)%>                       <!--Dipakai untuk mencek jumlah dokumen-dokumen yang akan dicetak-->

<!-- Konfigurasi Bagian [B]-->
<!--KONFIGURASI untuk menentukan jumlah baris dari line item yang ingin dicetak setiap halamannya-->
<!--Variabel berikut menentukan atau mengikuti 'layout' dari halaman kertas, sehingga menandakan batasan atau limit kertas-->
<%max_lines = 2%>                                      <!--Jumlah baris maksimum untuk line item s/d akhir halaman-->
<%def_footer_lines = 1%>                               <!--Jumlah pemakaian baris untuk footer yang akan dicetak setiap halamannya-->
<%last_page_footer_lines = 0%>                         <!--Jumlah pemakaian baris untuk footer yang akan dicetak khusus untuk halaman akhir-->
<%def_page_lines = max_lines - def_footer_lines%>       <!--Jumlah line item yang akan dicetak setiap halamannya-->
<%last_page_lines = max_lines - last_page_footer_lines%><!--Jumlah line item yang akan dicetak di halaman akhir-->
<%attachment_max_lines = 23%>                                      <!--Jumlah baris maksimum untuk line item s/d akhir halaman-->
<%attachment_def_footer_lines = 1%>                               <!--Jumlah pemakaian baris untuk footer yang akan dicetak setiap halamannya-->
<%attachment_last_page_footer_lines = 1%>
<%attachment_def_page_lines = attachment_max_lines - attachment_def_footer_lines%>       <!--Jumlah line item yang akan dicetak setiap halamannya-->
<%attachment_last_page_lines = attachment_max_lines - attachment_last_page_footer_lines%><!--Jumlah line item yang akan dicetak di halaman akhir-->
                                             <!--Konfigurasi ini apabila dikehendaki halaman akhir selalu fixed posisi footernya-->
<!-- Konfigurasi Bagian [C]-->
<!--KONFIGURASI untuk menentukan jumlah dan spesifikasi dari kolom untuk setiap baris line item yang akan dicetak-->
<%line_item_columns=2%>                                 <!--Jumlah kolom dari setiap baris line item yang dicetak-->
<%column_width_in_chars=[100,100]%>          <!--Lebar masing-masing kolom line item dalam jumlah huruf/karakter-->
<%max_wrap_lines=3%>                                    <!--Maksimum jumlah baris yang dibentuk untuk teks yang wrapping, sisa teks yang tidak 'muat' di'buang'-->
                                             <!--Nilai satu berarti tidak akan ada wrapping, sehingga semua teks untuk kolom akan di'truncate'-->
<%attachment_line_item_columns=2%>                                 <!--Jumlah kolom dari setiap baris line item yang dicetak-->
<%attachment_column_width_in_chars=[100,100]%>          <!--Lebar masing-masing kolom line item dalam jumlah huruf/karakter-->
<%attachment_max_wrap_lines=3%>
<!-- Konfigurasi Bagian [D]-->
<!--KONFIGURASI dapat digunakan untuk menentukan running total untuk setiap halaman berdasarkan kolom yang ditampilkan di area-->
<!--line item.-->
<%show_page_sum_top=True%>                              <!--Tampilkan 'Pindahan' (di atas line item)-->
<%show_page_sum_bottom=True%>                           <!--Tampilkan 'Dipindahkan' (di bawah line item)-->
<%num_of_sum_col=1%>                                    <!--Jumlah kolom yang akan dijumlah-->
<%show_line_item_cum_sum_by_page=[True,True,True]%>     <!--Hitung jumlah total per 'halaman' yang dicetak-->
<%sum_col_a=0%>                                         <!--Indeks 0 dari kolom yang dijumlah-->
<%sum_col_b=1%>                                         <!--Indeks 1 dari kolom yang dijumlah-->
<%sum_col_c=2%>                                         <!--Indeks 2 dari kolom yang dijumlah-->
<%sum_col_d=3%>                                         <!--Indeks 3 dari kolom yang dijumlah-->
<%sum_col_e=4%>                                         <!--Indeks 4 dari kolom yang dijumlah-->
<%sum_col_shown=sum_col_a%>                             <!--Indeks dari kolom dijumlah yang akan ditampilkan-->

<!-- Konfigurasi Bagian [E]-->
<!--KONFIGURASI untuk menentukan layout HTML dari formulir-->
<%preprinted_header_space = 226%>                       <!--Blank space untuk area preprinted dari formulir-->
<%line_item_height = 17%>                               <!--Tinggi dari setiap line item yang dicetak-->
<%font_size = 13%>                                      <!--Ukuran tulisan yang digunakan secara umum, dapat di-override apabila font-size juga ditentukan pada setiap tr atau td-->
<%page_width = 793%>                                    <!--Lebar formulir yang umum digunakan sebagai lebar tabel utama-->
<%page_height = 550%>                                  <!--Panjang formulir yang umum digunakan sebagai panjang tabel utama-->
<%padding_size = 5%>

<!--Layout untuk Area Banner (dalam pixel/px) -->
<%banner_width = page_width%>
<%banner_co_info_width = 0.6*banner_width%>
<%banner_logo_width = banner_width-banner_co_info_width%>
<%banner_doc_name_width = banner_logo_width%>
<%banner_line_width = banner_width%>
<%banner_height = 85%>
<%banner_line_height = 5%>
<%banner_co_info_height = banner_height-banner_line_height%>
<%banner_doc_name_height = 20%>
<%banner_logo_height = banner_co_info_height-banner_doc_name_height%>

<!--Layout untuk Area Info (dalam pixel/px-->
<%header_info_width= page_width%>
<%header_date_info_width= 0.5*page_width%>
<%header_date_label_info_width = 0.3*header_date_info_width%>
<%header_date_colon_info_width = 5%>
<%header_date_text_info_width = header_date_info_width-header_date_label_info_width-header_date_colon_info_width%>
<%header_no_info_width=page_width-header_date_info_width%>
<%header_no_label_info_width = 0.5*header_info_width%>
<%header_no_colon_info_width = 0%>
<%header_no_text_info_width = header_no_info_width-header_no_label_info_width-header_no_colon_info_width%>
<%header_info_height=50%>

<!--Layout untuk Area Header (dalam pixel/px) -->
<%header_width = page_width%>
<%header_label_width = round(0.194*header_width)%>
<%header_text_width = round(0.8*header_width)%>
<%header_colon_width =5%>
<%header_height = 140%>
<%header_label_height = 0.2*header_height%>
<%header_colon_height = 0.2*header_height%>
<%header_text_height = 0.2*header_height%>

<%attachment_header_height = 231%>

<!--Layout untuk area Referensi-->
<%ref_width = page_width%>
<%ref_label_width = round(0.194*ref_width)%>
<%ref_text_width = round(0.8*ref_width)%>
<%ref_colon_width = 5%>
<%ref_height = 50%>
<%ref_label_height=10%>
<%ref_colon_height=10%>
<%ref_text_height=10%>

<!--Layout untuk area amount said-->
<%amount_said_height=50%>
<%payment_for_height=50%>
<%attachment_payment_for_height=370%>
<%amount_said_width=round(0.8*page_width)%>

<!--Layout footer -->
<%footer_height = 120%>

<!--Layout untuk Area Signatory (dalam pixel/px) -->
<%signatory_width = page_width%>
<%no_of_signature = 3%>
<%signatory_signature_width = 150%>
<%signatory_note_width = signatory_width-(no_of_signature*signatory_signature_width)%>
<%signatory_height = 120%>
<%signatory_signature_height = signatory_height%>
<%signatory_note_height = signatory_height%>
<!--Layout untuk Area Tail (dalam pixel/px) -->
<%tail_width = page_width%>
<%tail_audit_width = 0.5*tail_width%>
<%tail_page_width = tail_width-tail_audit_width%>
<%tail_height = 15%>
<%tail_audit_height = tail_height%>
<%tail_page_height = tail_height%>
<!--Layout untuk Area Tail (dalam pixel/px) -->
<%filler_default_height =   page_height-banner_height-header_info_height-header_height-footer_height-signatory_height-tail_height%>
<%attachment_filler_default_height =   35%>
<!--filler_default_height ${filler_default_height},attachment_filler_default_height ${attachment_filler_default_height} -->
<!-- Konfigurasi Bagian [F]-->
<!--KONFIGURASI untuk menambah data testing-->
<%ttl_test_line = 0%>                                  <!--konfirgurasi untuk menambahkan jumlah body item line yang digunakan untuk testing-->
<%attachment_ttl_test_line = 0%>
<!-- Konfigurasi Opsional [G] -->
<%no_of_copies = 1%>                                    <!--Jumlah kopi yang perlu dicetak untuk setiap dokumen-->
<%show_banner=True%>                                    <!--Konfigurasi ini digunakan untuk menampilkan header-->
<%show_footer=True%>                                    <!--Konfigurasi ini digunakan untuk menampilkan footer-->
<%show_user=True%>                                      <!--Konfigurasi ini digunakan untuk menampilkan user yang mencetak-->
<%show_time_print=True%>                                <!--Konfigurasi ini digunakan untuk menampilkan waktu print yang berada di footer-->
<%show_debug_box = False%>                               <!--Konfigurasi ini digunakan untuk menampilkan garis/border yang berguna untuk mempermudah melakukan design-->
<%show_debug_value = False%>                             <!--Konfigurasi ini digunakan untuk testing wrapping pada signatory dan terbilang-->
<%show_logo = False%>                                    <!--Konfigurasi ini digunakan untuk menampilkan logo-->
<%show_company_info = False%>                            <!--Konfigurasi ini digunakan untuk menampilkan company info-->
<%show_page = True%>                                    <!--Konfigurasi ini digunakan untuk manampilkan penomoran halaman-->
<%show_writeoff = True%>                                  <!--Konfigurasi ini digunakan untuk manampilkan writeoff-->
<%show_attachment = True%>                                  <!--Konfigurasi ini digunakan untuk manampilkan lampiran-->
<%setLang('id_ID')%>

<!--
################################################################################
II. DEFINISI CSS STYLES
################################################################################
-->

<head>
<style type="text/css">
body.base {
font-size: ${font_size}px;
font-family: Sans-Serif;
margin: 0px;
}

table.banner {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${banner_height}px;
width: ${banner_width}px;
text-align: left;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout: auto;
}

td.banner_logo {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${banner_logo_height}px;
width: ${banner_logo_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.banner_doc_name {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${banner_doc_name_height}px;
width: ${banner_doc_name_width}px;
text-align: left;
vertical-align: bottom;
font-size: 15px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.banner_co_info {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: ${banner_co_info_height}px;
width: ${banner_co_info_width}px;
text-align: right;
vertical-align: bottom;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.banner_line {
%if show_debug_box:
border: 1px solid orange;
%endif
height: ${banner_line_height}px;
width: ${banner_line_width}px;
text-align: center;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.amount_said {
%if show_debug_box:
border: 1px solid purple;
%endif
width: ${amount_said_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: visible;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}
div.amount_said {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${0.90*amount_said_height}px;
width: ${0.90*amount_said_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: visible;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}
div.payment_for {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${0.90*payment_for_height}px;
}
div.attachment_payment_for {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${0.90*attachment_payment_for_height}px;
}
table.info {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: ${header_info_height}px;
/*text-align: left; */
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.header_date_info {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: {header_height}px;
width:{header_date_info_width}px;
/*text-align: left; */
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.header_no_info {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: {header_height}px;
width:{header_no_info_width}px;
/*text-align: left; */
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

table.header {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${header_height}px;
/*text-align: left; */
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

table.attachment_header {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${attachment_header_height}px;
/*text-align: left; */
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}
td.header_date_label_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_date_label_info_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}

td.header_date_colon_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_date_colon_info_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}


td.header_date_text_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_date_text_info_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}


td.header_no_label_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_no_label_info_width}px;
text-align: right;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}

td.header_no_colon_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_no_colon_info_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}


td.header_no_text_info
{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_no_text_info_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}


td.header_label{
%if show_debug_box:
border: 1px solid green;
%endif
width: ${header_label_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 10px;
padding-top: 0px;
padding-bottom: 0px;
}

td.header_colon{
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${header_label_height}px;
width: ${header_colon_width}px;
text-align: center;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.header_text {
%if show_debug_box:
border: 1px solid gray;
%endif
height: ${header_label_height}px;
width: ${header_text_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 10px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.ref_label {
%if show_debug_box:
border: 1px solid green;
%endif
height: ${header_label_height}px;
width: ${ref_label_width}px;
text-align: right;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 40px;
padding-top: 0px;
padding-bottom: 0px;
}

td.ref_colon{
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${header_colon_height}px;
width: ${ref_colon_width}px;
text-align: center;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}


td.ref_text {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${header_label_height}px;
width: ${ref_text_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 10px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

table.signatory {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${signatory_height}px;
width: ${signatory_width}px;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.signatory_note {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${signatory_note_height}px;
width: ${signatory_note_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

div.signatory_note {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: ${signatory_note_height}px;
width: ${0.9*signatory_note_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
overflow: hidden;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.signatory_signature {
%if show_debug_box:
border: 1px solid red;
%endif
height: ${signatory_signature_height}px;
width: ${signatory_signature_width}px;
text-align: center;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

table.tail {
%if show_debug_box:
border: 1px solid blue;
%endif
height: ${tail_height}px;
width: ${tail_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td.tail_audit {
%if show_debug_box:
border: 1px solid yellow;
%endif
height: ${tail_audit_height}px;
width: ${tail_audit_width}px;
text-align: left;
vertical-align: bottom;
font-size: 9px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

td.tail_page {
%if show_debug_box:
border: 1px solid magenta;
%endif
height: ${tail_page_height}px;
width: ${tail_page_width}px;
text-align: right;
vertical-align: bottom;
font-size: 9px;
font-family: Sans-Serif;
text-overflow: ellipsis;
overflow: hidden;
word-wrap:break-word;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
}

table.filler_default {
%if show_debug_box:
border: 1px solid black;
%endif
height: ${filler_default_height}px;
width: ${page_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}
table.attachment_filler_default {
%if show_debug_box:
border: 1px solid black;
%endif
height: ${attachment_filler_default_height}px;
width: ${page_width}px;
text-align: left;
vertical-align: top;
font-size: 12px;
font-family: Sans-Serif;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
padding-bottom: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

table {
border: 0px;
padding: 0px;
border-spacing: 0px;
border-collapse: collapse;
table-layout:fixed;
}

td {
padding: 0px;
text-overflow: ellipsis;
overflow: hidden;
}

p {
white-space: normal;
text-overflow:ellipsis;
font-size: 12px;
}

sup, sub
{
vertical-align: 0;
position: relative;
}

sup { bottom: 1ex; }
sub { top: 0.8ex; }

</style>
</head>

<!--pengaturan body dan tabel formulir-->
<body class="base">

<!--
################################################################################
III. PENGAMBILAN DAN PEMROSESAN DATA-DATA DARI DOKUMEN
################################################################################
-->
<!--LOOP 1: Iterasi untuk memproses setiap dokumen yang dipilih untuk di cetak-->
%for doc in objects:

<!-- MULAI DIUBAH 01 ========================================================-->
<!-- Hanya dokumen dengan status tertentu yang dapat dicetak -->
<!-- Mengubah state dokumen yang bisa dicetak -->
%if doc.state not in ('posted'):
<!-- AKHIR DIUBAH 01 ========================================================-->
<!-- Seluruh dokumen yang statusnya invalid akan di'catat' untuk -->
<!-- kemudian diinfokan ke pengguna -->
<% wrong_document_state.append('%s: %s' % (doc.name, doc.state)) %>
%else:
<!--Hanya proses dokumen dengan status yang valid-->

<!--
################################################################################
PRA-PROSES DATA: bagian ini adalah untuk memproses data line item yang akan dicetak.  Diperlukan proses awal (preprocessing) di mana teks atau
deskripsi dari line item yang akan dicetak di'parsing' untuk menentukan apakah akan ada 'wrapping' atau tidak.  Jika wrapping akan terjadi, maka
teks yang telah dibaca akan dipotong/split ke baris berikutnya (jumlah maksimum baris ditentukan oleh variabel max_wrap_lines).
Hasil akhir dari preprocessing data ini adalah suatu list dari baris atau line item yang akan dicetak (secara data type berupa list of list).
Untuk setiap baris yang juga berupa list data type, akan berisikan teks yang akan dicetak bagi masing-masing kolomnya.
Bagian pra-proses data ini secara umum dibagi menjadi beberapa langkah:
1. Pengambilan data dan penjumlahan data/kolom yang diinginkan
2. Penambahan dummy data untuk testing (ini sifatnya optional)
3. Penghitungan jumlah halaman yang akan dicetak
################################################################################
-->
<!--Menghitung baris line item yang akan dicetak-->
<!--Hitung jumlah produk atau line item yang akan diproses untuk dicetak-->
<%total_line_items = len(doc.line_ids)%>
<!--Siapkan variabel 'penyimpanan'-->
<%line_item_print=[]%>          <!--Tempat untuk menyimpan semua teks dari produk atau 'line item' yang telah di proses mengikuti konfigurasi kolom-->
<%total_lines_print=0%>         <!--Jumlah baris yang harus dicetak-->

<%line_item_sum_by_page=[]%>    <!--Jumlah atau total dari seluruh line item untuk setiap halamannya-->
<%line_item_to_sum=[]%>         <!--List dari seluruh nilai line item yang akan/dapat dijumlah-->
<%currency_digit = int(round(-log10(doc.currency_id.rounding)))%>

%if doc.type == "receipt":
 %if doc.amount < 0:
     <%line = doc.line_dr_ids + doc.line_cr_ids%>
 %else:
     <%line = doc.line_cr_ids + doc.line_dr_ids%>
 %endif
%else:
 %if doc.amount < 0:
     <%line = doc.line_cr_ids + doc.line_dr_ids%>
 %else:
     <%line = doc.line_dr_ids + doc.line_cr_ids%>
 %endif
%endif

<%prefix_invoice = {}%>
<%prefix_invoice[1] = 'Invoice'%>
<%prefix_invoice[2] = 'Refund Pembelian'%>
<%prefix_invoice[3] = 'Invoice'%>
<%prefix_invoice[4] = 'Refund Penjualan'%>

<%line_item_not_zero= 0%>
<%ttl_line_item_not_zero= 0%>


<!--menghitung jumlah line item kesluruhan yang tidak 0-->
<%ttl_all_line_item_not_zero = 0%>
%for line_itm_count in range(0,len(doc.line_ids)):
 <%line_itm = line[line_itm_count]%>
 %if str(line_itm.amount) != "0.0":
     <%ttl_all_line_item_not_zero = ttl_all_line_item_not_zero + 1%>
 %endif
%endfor
<!-- ttl_all_line_item_not_zero ${ttl_all_line_item_not_zero | entity} -->
%if ttl_all_line_item_not_zero == 1:
     <!--Proses semua produk di dalam dokumen yang dimaksud-->
 %while ttl_line_item_not_zero <= max_lines-2 and line_item_not_zero <= len(doc.line_ids)-1:

 <!-- %for line_item_count in range (0,line_item_not_zero=max_lines-1): -->
     <!--Ambil atau proses produk atau 'line item'nya-->
     <%line_item = line[line_item_not_zero]%>



     <!--menghitung line item yang amountnya tidak zero-->
     %if str(line_item.amount) != "0.0":
         <%line_item_to_sum.append([])%>
         <%str_holder=[]%>
         <%str_holder.append(line_item.move_line_id.move_id.name or '')%>
         <%str_holder.append(str(formatLang(line_item.amount, digits=2)) or '')%>
         <%ttl_line_item_not_zero= ttl_line_item_not_zero + 1%>


<!-- AKHIR DIUBAH 02 ========================================================-->

         <!--Ini adalah bagian yang me-wrap setiap baris line item sesuai-->
         <!--dengan konfigurasi [C] di atas. Untuk setiap produk yang-->
         <!--diproses, kita tambahkan satu list baru, jika terdapat-->
         <!--wrapping akan diproses/tambahkan di bagian wrapping-->
         <%no_lines=0%>
         <%line_item_print.append([])%>
         <%wrappable_column=0%>

         <%rv = wrap_line(str_holder, column_width_in_chars)%>

         <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
         <%str_holder = rv[1][:]%>
         <%line_item_print[total_lines_print] = rv[2][:]%>

         <!--Jika terdapat baris yang diproses, maka naikkan counter (hitungan)-->
         %if rv[0] >= 0:
             <%no_lines = no_lines + 1%>
             <%total_lines_print = total_lines_print + 1%>
         %endif
         %while (no_lines < max_wrap_lines) and (rv[0] > 0):
             <%line_item_print.append([])%>
             <%rv=wrap_line(str_holder, column_width_in_chars)%>

             <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
             <%str_holder = rv[1][:]%>
             <%line_item_print[total_lines_print] = rv[2][:]%>

             <%no_lines = no_lines + 1%>
             <%total_lines_print = total_lines_print + 1%>
         %endwhile
     %endif

     <%line_item_not_zero = line_item_not_zero + 1%>
 <!-- line_item_not_zero ${line_item_not_zero | entity} -->
 <!-- line_item.amount ${str(line_item.amount) | entity} -->
 <!-- %endfor -->
 %endwhile

%elif ttl_all_line_item_not_zero >= 2:
 %while ttl_line_item_not_zero <= max_lines-1 and line_item_not_zero <= len(doc.line_ids)-1:
 <!-- %for line_item_count in range (0,line_item_not_zero=max_lines-1): -->
     <!--Ambil atau proses produk atau 'line item'nya-->
     <%line_item = line[line_item_not_zero]%>
     <!-- line_item_not_zero ${line_item_not_zero | entity} -->


     <!--menghitung line item yang amountnya tidak zero-->
     %if str(line_item.amount) != "0.0":
         <%line_item_to_sum.append([])%>
         <%str_holder=[]%>
         <%str_holder.append(line_item.move_line_id.move_id.name or '')%>
         <%str_holder.append(str(formatLang(line_item.amount, digits=2)) or '')%>
         <%ttl_line_item_not_zero= ttl_line_item_not_zero + 1%>


<!-- AKHIR DIUBAH 02 ========================================================-->

         <!--Ini adalah bagian yang me-wrap setiap baris line item sesuai-->
         <!--dengan konfigurasi [C] di atas. Untuk setiap produk yang-->
         <!--diproses, kita tambahkan satu list baru, jika terdapat-->
         <!--wrapping akan diproses/tambahkan di bagian wrapping-->
         <%no_lines=0%>
         <%line_item_print.append([])%>
         <%wrappable_column=0%>

         <%rv = wrap_line(str_holder, column_width_in_chars)%>

         <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
         <%str_holder = rv[1][:]%>
         <%line_item_print[total_lines_print] = rv[2][:]%>

         <!--Jika terdapat baris yang diproses, maka naikkan counter (hitungan)-->
         %if rv[0] >= 0:
             <%no_lines = no_lines + 1%>
             <%total_lines_print = total_lines_print + 1%>
         %endif
         %while (no_lines < max_wrap_lines) and (rv[0] > 0):
             <%line_item_print.append([])%>
             <%rv=wrap_line(str_holder, column_width_in_chars)%>

             <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
             <%str_holder = rv[1][:]%>
             <%line_item_print[total_lines_print] = rv[2][:]%>

             <%no_lines = no_lines + 1%>
             <%total_lines_print = total_lines_print + 1%>
         %endwhile
     %endif

     <%line_item_not_zero = line_item_not_zero + 1%>
 <!-- line_item_not_zero ${line_item_not_zero | entity} -->
 <!-- line_item.amount ${str(line_item.amount) | entity} -->
 <!-- %endfor -->
 %endwhile

%endif

<!-- For testing only: adding dummy line items -->
<%test_lines = total_lines_print + ttl_test_line%>
%for line_number in range(total_lines_print,test_lines):
<!-- MULAI DIUBAH 03 ========================================================-->
 <!--Bagian ini hanya untuk testing dengan menambahkan line item-->
 <!--yang akan dicetak sesuai konfigurasi [F]. Tambahkan baris dummy-->
 <!--untuk testing, sesuaikan dengan jumlah kolom di konfigurasi [C]-->
 <%str_holder=[]%>
 <%str_holder.append('ABCDEFGHI')%>
 <%str_holder.append('8.888.888')%>
<!-- AKHIR DIUBAH 03 ========================================================-->

 <!--Ini adalah bagian yang me-wrap setiap baris line item sesuai dengan-->
 <!--konfigurasi [C] di atas. Untuk setiap produk yang diproses, kita-->
 <!--tambahkan satu list baru, jika terdapat wrapping akan diproses/tambahkan-->
 <!--di bagian wrapping-->
 <%no_lines=0%>
 <%line_item_print.append([])%>
 <%wrappable_column=0%>

 <%rv = wrap_line(str_holder, column_width_in_chars)%>

 <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
 <%str_holder = rv[1][:]%>
 <%line_item_print[total_lines_print] = rv[2][:]%>

 <!--Jika terdapat baris yang diproses, maka naikkan counter (hitungan)-->
 %if rv[0] >= 0:
     <%no_lines = no_lines + 1%>
     <%total_lines_print = total_lines_print + 1%>
 %endif
 %while (no_lines < max_wrap_lines) and (rv[0] > 0):
     <%line_item_print.append([])%>
     <%rv=wrap_line(str_holder, column_width_in_chars)%>

     <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
     <%str_holder = rv[1][:]%>
     <%line_item_print[total_lines_print] = rv[2][:]%>

     <%no_lines = no_lines + 1%>
     <%total_lines_print = total_lines_print + 1%>
 %endwhile

 <%line_item_to_sum.append([])%>
%endfor

<!-- Menghitung jumlah halaman formulir berdasarkan perhitungan def_page_lines-->
<% main_total_page = 1%> <!--selalu 1 untuk form kuitansi-->
%if last_page_footer_lines <= def_footer_lines:
 <!--Footer untuk halaman akhir akan muat, sehingga tidak perlu dibuatkan-->
 <!--halaman terakhir tambahan.-->
 <%blank_last_page = False%>
 <%compact_page = False%>
 %if fmod(total_lines_print, def_page_lines) > 0:
     <!--Jika terdapat sisa baris,maka sisa baris tersebut akan dicetak-->
     <!--dihalaman baru, yaitu halaman terakhir-->
     <%main_total_page = main_total_page + 1%>
 %endif
%else:
 <!--Footer untuk halaman akhir bisa bisa 'memakan' area line items, -->
 <!--sehingga mungkin perlu dibuatkan halaman baru.-->
 <%compact_page = True%>
 %if fmod(total_lines_print, def_page_lines) == 0:
     <!--Jika tidak terdapat sisa baris,maka footer halaman akhir akan-->
     <!--dicetak di halaman baru.-->
     <%main_total_page = main_total_page + 1%>
     <%blank_last_page = True%>
 %elif (fmod(total_lines_print, def_page_lines) + last_page_footer_lines) > max_lines:
     <!--Jika terdapat sisa baris dan area footer tidak cukup, maka akan ditambahkan 2 halaman baru-->
     <%main_total_page = main_total_page + 2%>
     <%blank_last_page = True%>
 %else:
     <%main_total_page = main_total_page + 1%>
     <%blank_last_page = False%>
 %endif
%endif


<!-- diubah ========================================================-->

<!--Menghitung baris line item yang akan dicetak-->
<!--Hitung jumlah produk atau line item yang akan diproses untuk dicetak-->




<%attachment_total_line_items = len(doc.line_ids)%>
<!--Siapkan variabel 'penyimpanan'-->
<%attachment_line_item_print=[]%>          <!--Tempat untuk menyimpan semua teks dari produk atau 'line item' yang telah di proses mengikuti konfigurasi kolom-->
<%attachment_total_lines_print=0%>         <!--Jumlah baris yang harus dicetak-->

<%attachment_line_item_sum_by_page=[]%>    <!--Jumlah atau total dari seluruh line item untuk setiap halamannya-->
<%attachment_line_item_to_sum=[]%>         <!--List dari seluruh nilai line item yang akan/dapat dijumlah-->
<%currency_digit = int(round(-log10(doc.currency_id.rounding)))%>

<!--Proses semua produk di dalam dokumen yang dimaksud-->
<%attachment_line_item_not_zero= 0%>
<!--Proses semua produk di dalam dokumen yang dimaksud-->
<!-- ${line_item_not_zero | entity}, ${len(doc.line_ids) | entity} -->
%for attachment_line_item_count in range (line_item_not_zero,len(doc.line_ids)):
 <!--Ambil atau proses produk atau 'line item'nya-->
<!-- attachment_line_item_count ${attachment_line_item_count | entity} -->
 <%attachment_line_item = line[attachment_line_item_count]%>
 %if str(attachment_line_item.amount) != "0.0":
     <%attachment_line_item_to_sum.append([])%>

     <%attachment_str_holder=[]%>
     <%attachment_str_holder.append(attachment_line_item.move_line_id.move_id.name or '')%>
     <%attachment_str_holder.append(str(formatLang(attachment_line_item.amount, digits=2)) or '')%>
     <%attachment_line_item_not_zero = attachment_line_item_not_zero + 1%>
<!-- AKHIR DIUBAH 02 ========================================================-->

     <!--Ini adalah bagian yang me-wrap setiap baris line item sesuai-->
     <!--dengan konfigurasi [C] di atas. Untuk setiap produk yang-->
     <!--diproses, kita tambahkan satu list baru, jika terdapat-->
     <!--wrapping akan diproses/tambahkan di bagian wrapping-->
     <%attachment_no_lines=0%>
     <%attachment_line_item_print.append([])%>
     <%attachment_wrappable_column=0%>

     <%rv = wrap_line(attachment_str_holder, attachment_column_width_in_chars)%>

     <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
     <%attachment_str_holder = rv[1][:]%>
     <%attachment_line_item_print[attachment_total_lines_print] = rv[2][:]%>

     <!--Jika terdapat baris yang diproses, maka naikkan counter (hitungan)-->
     %if rv[0] >= 0:
         <%attachment_no_lines = attachment_no_lines + 1%>
         <%attachment_total_lines_print = attachment_total_lines_print + 1%>
     %endif
     %while (attachment_no_lines < attachment_max_wrap_lines) and (rv[0] > 0):
         <%attachment_line_item_print.append([])%>
         <%rv=wrap_line(attachment_str_holder, attachment_column_width_in_chars)%>

         <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
         <%str_holder = rv[1][:]%>
         <%attachment_line_item_print[attachment_total_lines_print] = rv[2][:]%>

         <%attachment_no_lines = attachment_no_lines + 1%>
         <%attachment_total_lines_print = attachment_total_lines_print + 1%>
     %endwhile
 %endif
%endfor


<%attachment_test_lines = attachment_total_line_items + attachment_ttl_test_line%>
%for attachment_line_number in range(attachment_total_line_items,attachment_test_lines):
<!-- MULAI DIUBAH 03 ========================================================-->
 <!--Bagian ini hanya untuk testing dengan menambahkan line item-->
 <!--yang akan dicetak sesuai konfigurasi [F]. Tambahkan baris dummy-->
 <!--untuk testing, sesuaikan dengan jumlah kolom di konfigurasi [C]-->
 <%attachment_str_holder=[]%>
 <%attachment_str_holder.append('ABCDEFGHI')%>
 <%attachment_str_holder.append('8.888.888')%>
<!-- AKHIR DIUBAH 03 ========================================================-->

 <!--Ini adalah bagian yang me-wrap setiap baris line item sesuai dengan-->
 <!--konfigurasi [C] di atas. Untuk setiap produk yang diproses, kita-->
 <!--tambahkan satu list baru, jika terdapat wrapping akan diproses/tambahkan-->
 <!--di bagian wrapping-->
 <%attachment_no_lines=0%>
 <%attachment_line_item_print.append([])%>
 <%attachment_wrappable_column=0%>

 <%rv = wrap_line(attachment_str_holder, attachment_column_width_in_chars)%>

 <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
 <%attachment_str_holder = rv[1][:]%>
 <%attachment_line_item_print[attachment_total_lines_print] = rv[2][:]%>

 <!--Jika terdapat baris yang diproses, maka naikkan counter (hitungan)-->
 %if rv[0] >= 0:
     <%attachment_no_lines = attachment_no_lines + 1%>
     <%attachment_total_lines_print = attachment_total_lines_print + 1%>
 %endif
 %while (attachment_no_lines < attachment_max_wrap_lines) and (rv[0] > 0):
     <%attachment_line_item_print.append([])%>
     <%rv=wrap_line(attachment_str_holder, attachment_column_width_in_chars)%>

     <!--Ambil teks yang terbaru atau yang sudah diproses wrapping-nya-->
     <%attachment_str_holder = rv[1][:]%>
     <%attachment_line_item_print[attachment_total_lines_print] = rv[2][:]%>

     <%attachment_no_lines = attachment_no_lines + 1%>
     <%attachment_total_lines_print = attachment_total_lines_print + 1%>
 %endwhile

 <%attachment_line_item_to_sum.append([])%>
 <!--Loop ini diperlukan untuk menginisialisasi jumlah masing-masing kolom-->
 <!--Berapa jumlah kolom yang diinisialisasi tergantung kepada variabel -->
 <!--num_of_sum_col. Setelah inisialisasi selesai, seharusny ada 'row/list'-->
 <!--baru di variabel line_item_to_sum yang berupa list dari angka 0-->
 <!--(sebanyak num_of_sum_col).  Contoh [0, 0, 0], num_of_sum_col adalah 3-->
 <!--Setelah diinisialisasi, angka 0 tsb akan di overwrite dengan total/nilai-->
 <!--yang sesuai di bawah.-->

%endfor




<!-- Menghitung jumlah halaman formulir berdasarkan perhitungan def_page_lines-->
<% attachment_total_page = attachment_total_lines_print / attachment_def_page_lines%>
%if attachment_last_page_footer_lines <= attachment_def_footer_lines:
 <!--Footer untuk halaman akhir akan muat, sehingga tidak perlu dibuatkan-->
 <!--halaman terakhir tambahan.-->
 <%attachment_blank_last_page = False%>
 <%attachment_compact_page = False%>
 %if fmod(attachment_total_lines_print, attachment_def_page_lines) > 0:
     <!--Jika terdapat sisa baris,maka sisa baris tersebut akan dicetak-->
     <!--dihalaman baru, yaitu halaman terakhir-->
     <%attachment_total_page = attachment_total_page + 1%>
 %endif
%else:
 <!--Footer untuk halaman akhir bisa bisa 'memakan' area line items, -->
 <!--sehingga mungkin perlu dibuatkan halaman baru.-->
 <%attachment_compact_page = True%>
 %if fmod(attachment_total_lines_print, attachment_def_page_lines) == 0:
     <!--Jika tidak terdapat sisa baris,maka footer halaman akhir akan-->
     <!--dicetak di halaman baru.-->
     <%attachment_total_page = attachment_total_page + 1%>
     <%attachment_blank_last_page = True%>
 %elif (fmod(attachment_total_lines_print, attachment_def_page_lines) + attachment_last_page_footer_lines) > attachment_max_lines:
     <!--Jika terdapat sisa baris dan area footer tidak cukup, maka akan ditambahkan 2 halaman baru-->
     <%attachment_total_page = attachment_total_page + 2%>
     <%attachment_blank_last_page = True%>
 %else:
     <%attachment_total_page = attachment_total_page + 1%>
     <%attachment_blank_last_page = False%>
 %endif
%endif
<!-- akhir diubah ========================================================-->


<!--
################################################################################
IV. CETAK SESUAI DENGAN JUMLAH KOPI YANG DIPERLUKAN
############################################    ####################################
-->
<!-- no_of_copies ${no_of_copies | entity} -->
%for copy_no in range(0,no_of_copies):
 <%current_line = 0%>
 <%attachment_current_line = 0%>
 <%line_item_sum_by_page = []%>
 <%attachment_line_item_sum_by_page = []%>
<!--
################################################################################
V. BAGIAN PRE-PRINTED LAPORAN (LOGO)
################################################################################
-->

<!--Looping untuk menghasilkan ('render') halaman dari formulir-->
 %if ttl_all_line_item_not_zero <= 2:
     <%attachment_total_page = 0%>
 %endif
 <%total_page = main_total_page + attachment_total_page%>
 <%attachment_pages = False%>
 <!-- main_total_page ${main_total_page | entity} -->
 <!-- attachment_total_page ${attachment_total_page | entity} -->
 %for current_page in range(1, total_page + 1):
     <!-- total_page ${total_page | entity} -->
     %if current_page > main_total_page:
         <%attachment_pages = True%>
     %endif
<table class="base">
<!--
################################################################################
VI. BAGIAN BANNER
################################################################################
-->
<tr>
<td>
 <table class="banner">
     <tr>
         <!--Area Banner Kiri (Logo dan Nama Dokumen)-->
         <td>
             <table>
                 <!--Area untuk logo-->
                 <tr>
                     <td class="banner_logo">
                         %if show_logo:
                             ${helper.embed_logo_by_name('infinity_logo',60) | n}
                         %else:
                         ${}
                         %endif
                     </td>
                 </tr>
                 <!--Area untuk nama dokumen (misal FAKTUR)-->
                 <tr>
                     <td class="banner_doc_name">
                         %if not attachment_pages:
                             %if doc.type == "payment":
                                 %if doc.amount>=0:
                                     <i><b>KWITANSI PEMBELIAN</b></i>
                                 %else:
                                     <i><b>PENJUALAN PEMBELIAN</b></i>
                                 %endif
                             %else:
                                 %if doc.amount>=0:
                                     <i><b>KWITANSI PENJUALAN</b></i>
                                 %else:
                                     <i><b>REFUND PENJUALAN</b></i>
                                 %endif
                             %endif

                         %else:
                             %if doc.type == "payment":
                                 %if doc.amount>=0:
                                     <i><b>LAMPIRAN REFUND PEMBELIAN</b></i>
                                 %else:
                                     <i><b>LAMPIRAN KWITANSI PEMBELIAN</b></i>
                                 %endif
                             %else:
                                 %if doc.amount>=0:
                                     <i><b>LAMPIRAN KWITANSI PENJUALAN</b></i>
                                 %else:
                                     <i><b>LAMPIRAN REFUND PENJUALAN</b></i>
                                 %endif
                             %endif
                         %endif

                     </td>
                 </tr>
             </table>
         </td>
         <!--Area Banner Kanan (Company Info)-->
         <td style="vertical-align: bottom;">
             <table>
                 <td class="banner_co_info">
                     %if show_company_info:
                     ${doc.company_id and doc.company_id.name or ''|entity}<br>
                     ${doc.company_id and doc.company_id.street or ''|entity}<br>
                     ${doc.company_id and doc.company_id.partner_id.street2 or ''|entity} <br>
                     ${doc.company_id and doc.company_id.city or ''|entity} - ${doc.company_id and doc.company_id.zip or ''|entity}<br>
                     t: ${doc.company_id and doc.company_id.partner_id and doc.company_id.partner_id.phone or '' |entity} f: ${doc.company_id and doc.company_id.partner_id and doc.company_id.partner_id.fax or '' |entity} <br>
                     email: ${doc.company_id and doc.company_id.partner_id and doc.company_id.partner_id.email or '' |entity}
                     %else:
                     ${}
                     %endif
                 </td>
             </table>
         </td>
     </tr>
     <!-- Area garis bawah banner -->
     <tr>
         <td class="banner_line" colspan="2">
             <hr style="height: 1px; background: #000;">
         </td>
     </tr>
 </table>
</td>
</tr>

<!--
################################################################################
VII. BAGIAN HEADER
################################################################################
-->
<tr>
<td>
 <table class="info">
     <tr>
         <td class="header_date_info">
             <table>
                 <tr>
                     <td class="header_date_label_info">Tanggal</td>
                     <td class="header_date_colon_info">:</td>
                     <td class="header_date_text_info">${formatDate(doc.date, format='%d %b %Y')}</td>
                 </tr>
             </table>
         </td>

         <td class="header_no_info">
             <table >
                 <tr>
                     <td class="header_no_label_info"><b>Nomor. </b></td>
                     <td class="header_no_colon_info"></td>
                     <td class="header_no_text_info"><b>${doc.number}</b></td>
                 </tr>
             </table>
         </td>
     </tr>
 </table>
</td>
</tr>
<!--diubah -->

<!-- AKHIR JANGAN DIUBAH ====================================================-->


<!--akhir diubah -->
 %if not attachment_pages:
         %if compact_page and (current_page == main_total_page):
             <%last_line = current_line + (max_lines - last_page_footer_lines)%>
         %else:
             <%last_line = current_line + def_page_lines%>
         %endif



 %elif attachment_pages:
         %if attachment_compact_page and ((current_page-main_total_page) == attachment_total_page):
             <%attachment_last_line = attachment_current_line + (attachment_max_lines - attachment_last_page_footer_lines)%>
         %else:
             <%attachment_last_line = attachment_current_line + attachment_def_page_lines%>
         %endif

 %endif

<!-- Area Info Customer dan Dokumen -->
     %if not attachment_pages:
<tr>
<td>
 <table class="header">
     <tr>
         <td class="header_label">
                         %if doc.type == "payment":
                             %if doc.amount>=0:
                                 <b>Telah dibayar oleh</b></td>
                             %else:
                                 <b>Telah diterima dari</b></td>
                             %endif
                         %else:
                             %if doc.amount>=0:
                                 <b>Telah diterima dari</b></td>
                             %else:
                                 <b>Telah dibayar oleh</b></td>
                             %endif
                         %endif

         <td class="header_colon">:</td>
         <td class="header_text">
             ${doc.partner_id and doc.partner_id.name or ''|entity}
             %if doc.partner_id and doc.partner_id.parent_id and doc.partner_id.parent_id.name:
                 , ${doc.partner_id and doc.partner_id.parent_id and doc.partner_id.parent_id.name or ''|entity}<br>
             %else:
                 ${}
             %endif
             <br />
         </td>
     </tr>
     <tr>
         <td class="header_label"><b>Uang sejumlah</b></td>
         <td class="header_colon">:</td>
         <td class="header_text"><b>
             <b>
             <%doc_amt= formatLang(doc.amount, digits=2)%>
             <%doc_amt_without_min= str(doc_amt).replace("-","")%>

             ${doc.currency_id and doc.currency_id.symbol or '' |entity}
             </b>
             &nbsp;${ doc_amt_without_min or ''|entity}
             <br />
             </td>
     </tr>
     <tr>
         <td class="header_label"><b>Terbilang</b></td>
         <td class="header_colon">:</td>
         <td class="amount_said">
             <div class="amount_said">
                 <%amount=amount_to_text(abs(doc.amount), lang = getLang(), currency_obj=doc.currency_id)%>&nbsp;&nbsp;&nbsp;#&nbsp; ${amount or ''|entity} &nbsp;#
                 %if show_debug_value:
                     01the quick brown fox jumps over the crazy dog. 02the quick brown fox jumps over the crazy dog.
                     03the quick brown fox jumps over the crazy dog. 04the quick brown fox jumps over the crazy dog.
                     05the quick brown fox jumps over the crazy dog. 06the quick brown fox jumps over the crazy dog.
                     07the quick brown fox jumps over the crazy dog. 08the quick brown fox jumps over the crazy dog.
                     09the quick brown fox jumps over the crazy dog. 10the quick brown fox jumps over the crazy dog.
                     11the quick brown fox jumps over the crazy dog. 12the quick brown fox jumps over the crazy dog.
                     13the quick brown fox jumps over the crazy dog. 14the quick brown fox jumps over the crazy dog.
                     15the quick brown fox jumps over the crazy dog. 16the quick brown fox jumps over the crazy dog.
                     17the quick brown fox jumps over the crazy dog. 18the quick brown fox jumps over the crazy dog.
                     19the quick brown fox jumps over the crazy dog. 20the quick brown fox jumps over the crazy dog.
                 %endif
                 <br />
             </div>
         </td>
     </tr>
     <tr>
         <td class="header_label"><b>Untuk Pembayaran</b></td>
         <td class="header_colon">:</td>
         <td class="header_text">
                 <div class="payment_for">
                         %if doc.type == "payment":
                             %if doc.amount>=0:
                                 <%prefix = prefix_invoice.get(1)%>
                             %else:
                                 <%prefix = prefix_invoice.get(2)%>
                             %endif
                         %else:
                             %if doc.amount>=0:
                                 <%prefix = prefix_invoice.get(3)%>
                             %else:
                                 <%prefix = prefix_invoice.get(4)%>
                             %endif
                         %endif


                         %if ttl_all_line_item_not_zero == 1 :
                             <!--ini jalan ==1-->
                             %if line_item_print:
                                 %for line_no in range (current_line,last_line):
                                 %if line_no < max_lines-1:
                                         ${prefix}&nbsp;${line_item_print[line_no][0]}&nbsp; (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp;${line_item_print[line_no][1]})<br>
                                 %else:
                                     ${}
                                 %endif
                                 %endfor
                             %else:

                             %endif



                             %if doc.writeoff_amount and show_writeoff:
                                 <%write_off_amt=(doc.writeoff_amount)%>

                                 %if doc.payment_option == 'without_writeoff':
                                     Belum dialokasikan (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %else:
                                     ${doc.comment}&nbsp;(${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %endif
                             %endif

                         %elif ttl_all_line_item_not_zero == 2:
                              <!--ini jalan ==2-->
                             %if line_item_print:
                                 <!--current_line ${current_line |entity}, last_line ${last_line|entity}-->
                                 %for line_no in range (current_line,last_line+1):
                                     %if line_no <= max_lines:
                                             ${prefix}&nbsp;${line_item_print[line_no][0]}&nbsp; (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp;${line_item_print[line_no][1]})<br>
                                     %else:
                                         ${}
                                     %endif
                                 %endfor
                             %else:

                             %endif
                             %if doc.writeoff_amount and show_writeoff:
                                 <%write_off_amt=(doc.writeoff_amount)%>

                                 %if doc.payment_option == 'without_writeoff':
                                     Unallocated (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %else:
                                     ${doc.comment}&nbsp;(${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %endif
                             %endif

                         %elif ttl_all_line_item_not_zero > 2:
                             %if line_item_print:
                                 %for line_no in range (current_line,last_line+1):
                                     %if line_no < max_lines:
                                             ${prefix}&nbsp;${line_item_print[line_no][0]}&nbsp; (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp;${line_item_print[line_no][1]})<br>
                                     %else:
                                         ${}
                                     %endif
                                 %endfor
                             %else:

                             %endif
                             %if attachment_total_page > 0 and show_attachment:

                                 <b style="font-size: 7pt;font-style: italic;">
                                     *see attachment<br>
                                 </b>
                             %endif
                         %elif ttl_all_line_item_not_zero == 0:
                             %if doc.writeoff_amount and show_writeoff:
                                 <%write_off_amt=(doc.writeoff_amount)%>

                                 %if doc.payment_option == 'without_writeoff':
                                     Belum dialokasikan (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %else:
                                     ${doc.comment}&nbsp;(${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                                 %endif
                             %endif

                         %endif


                         <%current_line = last_line%>
                 </div>
         </td>
     </tr>
     <tr>
         <td class="header_label"><b>Referensi Pembayaran</b></td>
         <td class="header_colon"></td>
     </tr>
     <tr>
         <td class="ref_label"><b>No Ref / Memo</b></td>
         <td class="ref_colon">:</td>
         <td class="ref_text">${doc.reference or '-' |entity} / ${doc.name or '-' |entity}  <br /></td>
     </tr>
     <tr>
         <td class="header_label">
             %if doc.type=='receipt':
                 <%payment= 'Diterima melalui'%>
             %else:
                 <%payment= 'Dibayarkan melalui'%>
             %endif
             <b>${payment}</b>
         </td>
         <td class="header_colon">:</td>
         <td class="header_text">${doc.journal_id and doc.journal_id.name or '' |entity} <br /></td>
     </tr>
 </table>
</td>
</tr>
     %endif
     %if attachment_pages:
<tr>
<td>
 <table class="attachment_header">
     <tr>
         <td class="header_label"><b>Untuk Pembayaran</b></td>
         <td class="header_colon">:</td>
         <td class="header_text">
                 <div class="attachment_payment_for">
                         %if doc.type == "payment":
                             %if doc.amount>=0:
                                 <%prefix = prefix_invoice.get(1)%>
                             %else:
                                 <%prefix = prefix_invoice.get(2)%>
                             %endif
                         %else:
                             %if doc.amount>=0:
                                 <%prefix = prefix_invoice.get(3)%>
                             %else:
                                 <%prefix = prefix_invoice.get(4)%>
                             %endif
                         %endif

                         %if attachment_line_item_print:
                             %for line_no in range (attachment_current_line,attachment_last_line):
                             %if line_no < attachment_total_lines_print:
                                     ${prefix}&nbsp;${attachment_line_item_print[line_no][0]}&nbsp; (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${attachment_line_item_print[line_no][1]})<br>
                             %else:
                                 ${}
                             %endif
                             %endfor
                         %else:

                         %endif

                         %if doc.writeoff_amount and show_writeoff and current_page == total_page:
                             <%write_off_amt=(doc.writeoff_amount)%>

                             %if doc.payment_option == 'without_writeoff':
                                 Belum dialokasikan (${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                             %else:
                                 ${doc.comment}&nbsp;(${doc.currency_id and doc.currency_id.symbol or '' |entity} &nbsp; ${write_off_amt|entity})
                             %endif
                         %endif
                         <%attachment_current_line = attachment_last_line%>
                 </div>
         </td>
     </tr>
 </table>
</td>
</tr>
     %endif
<!--
################################################################################
VIII. BAGIAN BODY / LINE ITEM (TABEL ITEM)
################################################################################
-->





<!--
################################################################################
IX. BAGIAN FOOTER FORMULIR
################################################################################
-->

<!--
################################################################################
X. BAGIAN FILLER
################################################################################
-->
<tr>
<td>
 %if not attachment_pages:
 <table class="filler_default">
     <td>
         %if show_debug_value:
             Filler default height: ${filler_default_height}px

             ${page_height}-${banner_height}-${header_info_height}-${header_height}-${signatory_height}-${tail_height}
         %else:
         %endif
     </td>
 </table>
 %endif
 %if attachment_pages:
 <table class="attachment_filler_default">
     <td>
         %if show_debug_value:
             Filler default height: ${attachment_filler_default_height}px

             ${page_height}-${banner_height}-${header_info_height}-${header_height}-${signatory_height}-${tail_height}
         %else:
         %endif
     </td>
 </table>
 %endif
</td>
</tr>

<!--
################################################################################
XI. BAGIAN SIGNATORY FORMULIR
################################################################################
-->
     %if not attachment_pages:
<tr>
<td style="text-align: center;">
 <table class="signatory">
     <tr>
         <!-- Area cetak catatan-->
         <td class="signatory_note">
             <table>
                 <tr>
                     <td>
                         <div class="signatory_note">

                         </div>
                     </td>
                 </tr>
             </table>
         </td>
         %if doc.type=='receipt':
         <td class="signatory_signature" >
             Yang Menerima
         </td>
         %else:
         <td class="signatory_signature" >
             Yang Mengeluarkan
         </td>
         <td class="signatory_signature">
             Yang Menyetujui
         </td>
         <td class="signatory_signature">
             Yang Menerima
         </td>
         %endif
     </tr>
 </table>
</td>
</tr>
     %endif

<!--
################################################################################
XII. BAGIAN HALAMAN
################################################################################
-->
<tr>
<td>
 <table class="tail">
     <tr>
         <td class="tail_audit">
             %if show_user:
                 Dicetak oleh ${user.name or ''|entity}
             %else:
                 ${}
             %endif
             %if show_time_print:
                 pada ${time.strftime('%d %h %Y %r')}
             %else:
                 ${}
             %endif
         </td>
         <td class="tail_page" >
         %if show_page:
             Hal ${current_page} dari ${total_page}
         %else:
             ${}
         %endif
         </td>
     </tr>
 </table>
</td>
</tr>
</table>

     <!-- Insert page break untuk setiap halaman kecuali halaman terakhir -->
     %if current_page < total_page:
 <p style="page-break-after:always; margin: 0px;"></p>
     %endif
 <!-- Akhir dari loop untuk mencetak lebih dari 1 halaman -->
 %endfor

 <!-- Inset page break untuk akhir setiap pencetakan 1 kopi kecuali setelah pencetakan kopi terakhir -->
 %if copy_no < (no_of_copies-1):
 <p style="page-break-after:always; margin: 0px;"></p>
 %endif
<!-- Akhir dari loop untuk mencetak lebih dari 1 kopi -->
%endfor

<!-- Tambahkan page break setiap pencetakan dokumen, kecuali untuk dokumen terakhir-->
%if total_document > 1:
     <p style="page-break-after:always; margin: 0px;"></p>
 <%total_document = total_document - 1 %>
%endif

<!-- Akhir kondisi yang mencek status dari dokumen yang dicetak -->
%endif

<!-- Akhir dari loop untuk mencetak lebih dari 1 dokumen -->
%endfor

<!--
################################################################################
XIII. WRONG STATE STATEMENT
################################################################################
-->

%if wrong_document_state:
<p style="page-break-after:always"></p>
<small>
<br/><br/><br/>
<b>These documents can't be printed due to their statuses:</b><br/>
${', '.join(wrong_document_state)}
</small>
%endif

</body>
</html>
]]>
            </field>
        </record>

        <!-- Activate the form -->
        <function model="via.form.templates" name="activate"
            eval="[ ref('client_form_kuitansi_id') ], " />
    </data>
</openerp>
